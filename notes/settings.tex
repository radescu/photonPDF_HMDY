\section{Settings}
\label{sec:fitsettings}

This section presents the settings of the PDF fits, including the details about the
parametrisation of the photon PDF $x\gamma(x,Q^2)$, which have been
carried out using the open-source {\tt xFitter}
framework~\cite{Alekhin:2014irh}.
%
First of all, the scale $Q_0^2$ at which PDFs are parametrised is taken to be
$Q_0^2 = 7.5~$GeV$^2$, which coincides with the value $Q_{\rm min}^2$ that defines
the kinematic cut $Q^2 \ge Q_{\rm min}^2$ for the
data points that are used as input to the fits.
%
The charm PDF is then generated perturbatively from quarks and gluons by
means of DGLAP evolution, exploiting recent developments in {\tt
  APFEL} which allow the setting of heavy-quark thresholds $\mu_h$
differently from the heavy quark masses $m_h$, such that
$\mu_c=Q_0 > m_c$. Hence a high threshold can be used without having to parametrise the charm PDF \cite{current:work}.
% as done in~\cite{Ball:2016neh}.

The expression for the $\chi^2$  function used for the fits is that
of Ref.~\cite{Aaron:2012qi}, which
includes corrections for possible 
biases from statistical fluctuations and treats the systematic uncertainties
multiplicatively.
%
Alternative forms that do not include these corrections, such as those
defined in~\cite{Aaron:2009aa,Abramowicz:2015mha},
have also been studied but no significant differences
in the results have been observed.
%

In this analysis, the parametrised PDFs are the valence distributions
$xu_{v}(x,Q_0^2)$ and $xd_{v}(x,Q_0^2)$, the gluon distribution $xg(x,Q_0^2)$, and the
\textit{u}-type and \textit{d}-type sea-quark distributions,
$x\bar{U}(x,Q_0^2)$, $x\bar{D}(x,Q_0^2)$, where $x\bar{U}(x,Q_0^2) = x\bar{u}(x,Q_0^2)$ and
$x\bar{D}(x,Q_0^2) = x\bar{d}(x,Q_0^2) + x\bar{s}(x,Q_0^2)$.
%
In addition, the photon distribution $x\gamma(x,Q_0^2)$ is also parametrised at the starting scale.
%
The following general functional form is adopted:
\begin{equation}
  \label{eq:parametrization}
xf(x, Q_0^2) = Ax^{B}(1-x)^{C}(1+Dx+Ex^{2}) \, ,
\end{equation}
where some of the normalisation parameters, in particular $A_{u_{v}}$,
$A_{d_{v}}$ and $A_{g}$, are constrained by the valence and momentum
sum rules (note that the photon PDF also enters the momentum sum rule).
%
The parameters $B_{\bar{U}}$ and $B_{\bar{D}}$ are set equal to each
other, so that the two quark sea distributions share a common
small-$x$ behaviour.
%
Since the measurements used here are not sensitive to the strangeness
content of the proton, strageness is fixed such that $x\bar{s} (x, Q_0^2) = r_sx\bar{d}(x,Q_0^2)$, where
$r_s=1.0$ is consistent with the ATLAS analysis of inclusive $W$
and $Z$ production~\cite{Aad:2012sb,Aaboud:2016btc}.
%
The further constraint $A_{\bar{U}} = 0.5 A_{\bar{D}}$ is imposed,
such that $x\bar{u}(x,Q_0^2) \to x\bar{d}(x,Q_0^2)$ as $x \to 0$.  

The explicit form of PDF parametrisation Eq.~(\ref{eq:parametrization})
at the scale $Q_0^2$ is determined by the
technique of saturation of the $\chi^{2}$, namely the number of parameters is increased 
one by one  until the $\chi^{2}$ does not improve
further, employing Wilks' theorem~\cite{Wilks:1938dza}.
%
Following this method, the optimal parametrisation for the quark and
gluon PDFs found for this analysis is:
\begin{eqnarray}
  \nonumber
  xu_v(x) &&= A_{u_v}x^{B_{u_v}}(1-x)^{C_{u_v}}(1+E_{u_v}x^{2})\, , \\
  \nonumber
xd_v(x) &&= A_{d_v}x^{B_{d_v}}(1-x)^{C_{d_v}}\, , \\
x\bar{U}(x) &&= A_{\bar{U}}x^{B_{\bar{U}}}(1-x)^{C_{\bar{U}}}\, , \\
\nonumber
x\bar{D}(x) &&= A_{\bar{D}}x^{B_{\bar{D}}}(1-x)^{C_{\bar{D}}}\, , \\
\nonumber
\label{eq:param}
xg(x) &&= A_{g}x^{B_{g}}(1-x)^{C_{g}}(1+E_{g}x^{2})\, ,
\end{eqnarray}
while for the photon PDF it is used:
\begin{equation}
x\gamma(x) = A_{\gamma}x^{B_{\gamma}}(1-x)^{C_{\gamma}}(1+D_{\gamma}x+E_{\gamma}x^{2}) \, .
\end{equation}


The parametrisation of the quark and gluon PDFs in
Eq.~(\ref{eq:param}) differs from the one used in the HERAPDF2.0
analysis in various ways.
%
First of all, a higher value of the input evolution scale
$Q_0^2$ is used, which is helpful to stabilise the fit of the photon PDF.
%
Second, an additional negative term in the parametrisation of the
gluon is not required here, because of the increased value of $Q_0^2$
which assures the positiveness of the gluon distribution.
%
Third, the results of the parametrisation scan are different because of the
inclusion of the ATLAS high-mass Drell-Yan cross-section data.

PDF uncertainties are estimated using the Monte Carlo replica
method~\cite{DelDebbio:2004xtd,DelDebbio:2007ee,Ball:2008by},
cross-checked with
the Hessian method~\cite{Pumplin:2001ct} using $\Delta\chi^2=1$.
%
The former is expected to be more robust than the latter, due to the
potential non-Gaussian nature of the photon PDF
uncertainties~\cite{Ball:2013hta}.
%
In Section \ref{sec:results} it is shown that these two methods to estimate the PDF uncertainties
on the photon PDF lead to similar results.

In addition, a number of cross-checks have been performed to assess the
impact of various model and parametrisation uncertainties.
%
For the model uncertainties, variations of the charm mass
between $m_c=1.41$ GeV to 1.53 GeV, of the bottom mass between
$m_c=4.25$ GeV to 4.75 GeV, of the strong coupling constant
$\alpha_s(m_Z)$ between 0.116 to 0.120 are considered, and additionally the
strangeness fraction is decreased down to $r_s=0.75$.
%
For the parametrisation uncertainties, the impact
of increasing the input parametrisation scale up to $Q_0^2=10$~GeV$^2$ is considered as well as the impact of including additional parameters in Eq.~(\ref{eq:param}).
%
These extra parameters
make little difference to the $\chi^2$ of the fit, but they can
change the shape of the PDFs in a non-negligible way.
%
Such additional parameters are  $D_{u_v}$, $D_{\bar{u}}$, $E_{\bar{d}}$, as well
and the extra negative term  in the gluon PDF used in HERAPDF2.0.
%
The impact of these model and parametrisation uncertainties on the baseline results
is quantified in Sect.~\ref{sec:crosschecks}.
